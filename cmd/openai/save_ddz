___SPLITTER_ORIGINAL___6L+Z5piv5LiA5Liq566A5Y2V55qE5paX5Zyw5Li75ri45oiP77yM5biu5oiRIGRlYnVnIOS4gOS4iwoKYGBgcHl0aG9u___SPLITTER_ORIGINAL___aW1wb3J0IHNvY2tldAppbXBvcnQgdGhyZWFkaW5nCmltcG9ydCByYW5kb20KaW1wb3J0IGxvZ2dpbmcKZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgQ291bnRlciwgZGVmYXVsdGRpY3QKCiMg6YWN572u5pel5b+XCmxvZ2dpbmcuYmFzaWNDb25maWcobGV2ZWw9bG9nZ2luZy5ERUJVRywgZm9ybWF0PSclKGFzY3RpbWUpcyAlKG1lc3NhZ2UpcycpCgojIOWumuS5ieeJjOeahOmhuuW6jwpDQVJEX09SREVSID0gJzM0NTY3ODkwSlFLQTJCUicKCiMg5bCG54mM6L2s5o2i5Li65Y+v5Lul5q+U6L6D55qE5YC8CkNBUkRfVkFMVUVTID0ge2NhcmQ6IGluZGV4IGZvciBpbmRleCwgY2FyZCBpbiBlbnVtZXJhdGUoQ0FSRF9PUkRFUil9CgpjbGFzcyBSb29tOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYucGxheWVycyA9IFtdCiAgICAgICAgc2VsZi5yZWFkeV9wbGF5ZXJzID0gW10KICAgICAgICBzZWxmLnBsYXllcl9jb3VudCA9IDAgICMg5re75Yqg6L+Z5LiA6KGMCiAgICAgICAgc2VsZi5sYW5kbG9yZF9iaWQgPSAtMQogICAgICAgIHNlbGYudHVybiA9IDAKICAgICAgICBzZWxmLmxhc3RfcGxheSA9IE5vbmUKCiAgICBkZWYgYWRkX3BsYXllcihzZWxmLCBwbGF5ZXIpOgogICAgICAgIGlmIGxlbihzZWxmLnBsYXllcnMpIDwgMzoKICAgICAgICAgICAgZm9yIGksIHBsIGluIGVudW1lcmF0ZShzZWxmLnBsYXllcnMpOgogICAgICAgICAgICAgICAgaWYgcGwuaWQgPT0gcGxheWVyLmlkOgogICAgICAgICAgICAgICAgICAgIHNlbGYucGxheWVyc1tpXSA9IHBsYXllcgogICAgICAgICAgICAgICAgICAgIHBsYXllci5oYW5kID0gcGwuaGFuZCAgIyDmgaLlpI3njqnlrrbmlq3nur/liY3nmoTmiYvniYwKICAgICAgICAgICAgICAgICAgICBzZWxmLmJyb2FkY2FzdChmIlBsYXllciB7cGxheWVyLmlkfSByZWpvaW5lZCB0aGUgcm9vbSIpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50X3BsYXllcigpLnNlbmRfbWVzc2FnZShmIkl0J3MgeW91ciB0dXJuIHRvIHBsYXkgY2FyZHMuIFlvdXIgaGFuZDogeycnLmpvaW4oc2VsZi5jdXJyZW50X3BsYXllcigpLmhhbmQpfSIpCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIAogICAgICAgICAgICBzZWxmLnBsYXllcnMuYXBwZW5kKHBsYXllcikKICAgICAgICAgICAgc2VsZi5wbGF5ZXJfY291bnQgKz0gMQogICAgICAgICAgICBzZWxmLmJyb2FkY2FzdChmIlBsYXllciB7cGxheWVyLmlkfSBqb2luZWQgdGhlIHJvb20iKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGZvciBpLCBwbCBpbiBlbnVtZXJhdGUoc2VsZi5wbGF5ZXJzKToKICAgICAgICAgICAgICAgIGlmIHBsLmlkID09IHBsYXllci5pZDoKICAgICAgICAgICAgICAgICAgICBzZWxmLnBsYXllcnNbaV0gPSBwbGF5ZXIKICAgICAgICAgICAgICAgICAgICBwbGF5ZXIuaGFuZCA9IHBsLmhhbmQgICMg5oGi5aSN546p5a625pat57q/5YmN55qE5omL54mMCiAgICAgICAgICAgICAgICAgICAgc2VsZi5icm9hZGNhc3QoZiJQbGF5ZXIge3BsYXllci5pZH0gcmVqb2luZWQgdGhlIHJvb20iKQogICAgICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudF9wbGF5ZXIoKS5zZW5kX21lc3NhZ2UoZiJJdCdzIHlvdXIgdHVybiB0byBwbGF5IGNhcmRzLiBZb3VyIGhhbmQ6IHsnJy5qb2luKHNlbGYuY3VycmVudF9wbGF5ZXIoKS5oYW5kKX0iKQogICAgICAgICAgICAgICAgICAgIHJldHVybiAKICAgICAgICAgICAgIyBJZiBnYW1lIGFscmVhZHkgc3RhcnRlZCwgZG8gbm90IGFsbG93IG5ldyBwbGF5ZXJzIGFuZCBjbG9zZSBjb25uZWN0aW9uCiAgICAgICAgICAgIHBsYXllci5zZW5kX21lc3NhZ2UoIkdhbWUgYWxyZWFkeSBzdGFydGVkLiBObyBuZXcgcGxheWVycyBhbGxvd2VkLiIpCiAgICAgICAgICAgIHBsYXllci5jb25uLmNsb3NlKCkgICMg56uL5Y2z5YWz6Zet6L+e5o6l77yM6YG/5YWN6ZSZ6K+vCiAgICAgICAgICAgIHJldHVybgoKICAgIGRlZiByZW1vdmVfcGxheWVyKHNlbGYsIHBsYXllcik6CiAgICAgICAgaWYgcGxheWVyIGluIHNlbGYucGxheWVyczogICMg5aKe5Yqg5qOA5p+l546p5a625piv5ZCm5Zyo5YiX6KGo5LitCiAgICAgICAgICAgIHNlbGYucGxheWVycy5yZW1vdmUocGxheWVyKQogICAgICAgICAgICBsb2dnaW5nLmluZm8oZiJQbGF5ZXIge3BsYXllci5pZH0gbGVmdCB0aGUgcm9vbSIpCiAgICAgICAgICAgIHNlbGYuYnJvYWRjYXN0KGYiUGxheWVyIHtwbGF5ZXIuaWR9IGxlZnQgdGhlIHJvb20iKQoKICAgIGRlZiBicm9hZGNhc3Qoc2VsZiwgbWVzc2FnZSk6CiAgICAgICAgZm9yIHBsYXllciBpbiBzZWxmLnBsYXllcnM6CiAgICAgICAgICAgIHBsYXllci5zZW5kX21lc3NhZ2UobWVzc2FnZSkKCiAgICBkZWYgc3RhcnRfZ2FtZShzZWxmKToKICAgICAgICBpZiBsZW4oc2VsZi5wbGF5ZXJzKSAhPSAzOgogICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICAKICAgICAgICBzZWxmLmJyb2FkY2FzdCgiR2FtZSBzdGFydHMhIikKICAgICAgICAjIFNodWZmbGUgYW5kIGRlYWwgY2FyZHMKICAgICAgICBzZWxmLmRlYWxfY2FyZHMoKQoKICAgICAgICAjIEFzc2lnbiBhIHJhbmRvbSBwbGF5ZXIgdG8gc3RhcnQgYmlkZGluZyBmb3IgbGFuZGxvcmQKICAgICAgICBzZWxmLmN1cnJlbnRfYmlkZGVyID0gcmFuZG9tLnJhbmRpbnQoMCwgMikKICAgICAgICBzZWxmLmxhbmRsb3JkX2JpZCA9IC0xCgogICAgICAgIHNlbGYuYnJvYWRjYXN0KCJCaWRkaW5nIGZvciBsYW5kbG9yZCBiZWdpbnMiKQogICAgICAgIHNlbGYuYmlkX2xhbmRsb3JkKCkKICAgICAgICByZXR1cm4gVHJ1ZQoKICAgIGRlZiBkZWFsX2NhcmRzKHNlbGYpOgogICAgICAgIGRlY2sgPSAobGlzdChDQVJEX09SREVSKSAqIDQpWzo1Ml0gICMg5L+d6K+B5Y+q5pyJNTLlvKDniYwKICAgICAgICBkZWNrLmV4dGVuZChbJ0InLCAnUiddKSAgIyDnoa7kv53lj6rmnInkuIDkuKrlpKfnjovlkozkuIDkuKrlsI/njosKICAgICAgICByYW5kb20uc2h1ZmZsZShkZWNrKQoKICAgICAgICBzZWxmLnBsYXllcl9oYW5kcyA9IFtkZWNrW2kgKiAxNzogKGkgKyAxKSAqIDE3XSBmb3IgaSBpbiByYW5nZSgzKV0KICAgICAgICBzZWxmLmxhbmRsb3JkX2NhcmRzID0gZGVja1stMzpdCgogICAgICAgIGZvciBpLCBwbGF5ZXIgaW4gZW51bWVyYXRlKHNlbGYucGxheWVycyk6CiAgICAgICAgICAgIHBsYXllci5oYW5kID0gc29ydGVkKHNlbGYucGxheWVyX2hhbmRzW2ldLCBrZXk9bGFtYmRhIHg6IENBUkRfVkFMVUVTW3hdKQogICAgICAgICAgICBwbGF5ZXIuc2VuZF9tZXNzYWdlKGYiWW91ciBoYW5kOiB7Jycuam9pbihwbGF5ZXIuaGFuZCl9IikKCiAgICBkZWYgYmlkX2xhbmRsb3JkKHNlbGYpOgogICAgICAgIHNlbGYuY3VycmVudF9wbGF5ZXIoKS5zZW5kX21lc3NhZ2UoIkRvIHlvdSB3YW50IHRvIGJlIHRoZSBsYW5kbG9yZD8gKFEgZm9yIFllcywgTiBmb3IgTm8pIikKCiAgICBkZWYgaGFuZGxlX2JpZChzZWxmLCBwbGF5ZXIsIGJpZCk6CiAgICAgICAgaWYgcGxheWVyICE9IHNlbGYuY3VycmVudF9wbGF5ZXIoKToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIGJpZCA9PSAnUSc6CiAgICAgICAgICAgIHNlbGYubGFuZGxvcmRfYmlkID0gc2VsZi5jdXJyZW50X2JpZGRlcgogICAgICAgICAgICBzZWxmLmJyb2FkY2FzdChmIlBsYXllciB7cGxheWVyLmlkfSBiaWRzIGZvciBsYW5kbG9yZCIpCiAgICAgICAgICAgIHNlbGYuc3RhcnRfcm91bmRzKCkKICAgICAgICBlbGlmIGJpZCA9PSAnTic6CiAgICAgICAgICAgIHNlbGYuY3VycmVudF9iaWRkZXIgPSAoc2VsZi5jdXJyZW50X2JpZGRlciArIDEpICUgMwogICAgICAgICAgICBpZiBzZWxmLmN1cnJlbnRfYmlkZGVyID09IHNlbGYudHVybjoKICAgICAgICAgICAgICAgIHNlbGYuc3RhcnRfcm91bmRzKCkKICAgICAgICAgICAgICAgIHJldHVybgoKICAgICAgICAgICAgc2VsZi5iaWRfbGFuZGxvcmQoKQoKICAgIGRlZiBzdGFydF9yb3VuZHMoc2VsZik6CiAgICAgICAgc2VsZi5icm9hZGNhc3QoZiJQbGF5ZXIge3NlbGYucGxheWVyc1tzZWxmLmxhbmRsb3JkX2JpZF0uaWR9IGlzIHRoZSBsYW5kbG9yZCIpCiAgICAgICAgc2VsZi5wbGF5ZXJzW3NlbGYubGFuZGxvcmRfYmlkXS5oYW5kICs9IHNlbGYubGFuZGxvcmRfY2FyZHMKICAgICAgICBzZWxmLnBsYXllcnNbc2VsZi5sYW5kbG9yZF9iaWRdLmhhbmQgPSBzb3J0ZWQoc2VsZi5wbGF5ZXJzW3NlbGYubGFuZGxvcmRfYmlkXS5oYW5kLCBrZXk9bGFtYmRhIHg6IENBUkRfVkFMVUVTW3hdKQogICAgICAgIHNlbGYudHVybiA9IHNlbGYubGFuZGxvcmRfYmlkCgogICAgICAgIGZvciBwbGF5ZXIgaW4gc2VsZi5wbGF5ZXJzOgogICAgICAgICAgICBwbGF5ZXIuc2VuZF9tZXNzYWdlKGYiWW91ciBoYW5kOiB7Jycuam9pbihwbGF5ZXIuaGFuZCl9IikKCiAgICAgICAgc2VsZi5icm9hZGNhc3QoZiJMYW5kbG9yZCBzdGFydHMgdGhlIGdhbWUiKQogICAgICAgIHNlbGYuY3VycmVudF9wbGF5ZXIoKS5zZW5kX21lc3NhZ2UoIkl0J3MgeW91ciB0dXJuIHRvIHBsYXkgY2FyZHMiKQoKICAgIGRlZiBwbGF5X2NhcmRzKHNlbGYsIHBsYXllciwgY2FyZHMpOgogICAgICAgIGlmIHBsYXllciAhPSBzZWxmLmN1cnJlbnRfcGxheWVyKCk6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICAjIOWmguaenOeOqeWutumAieaLqei3s+i/hwogICAgICAgIGlmIGNhcmRzID09ICcnOgogICAgICAgICAgICBzZWxmLmJyb2FkY2FzdChmIlBsYXllciB7cGxheWVyLmlkfSBwYXNzZXMiKQogICAgICAgICAgICBzZWxmLnR1cm4gPSAoc2VsZi50dXJuICsgMSkgJSAzCiAgICAgICAgICAgIHNlbGYuY3VycmVudF9wbGF5ZXIoKS5zZW5kX21lc3NhZ2UoZiJJdCdzIHlvdXIgdHVybiB0byBwbGF5IGNhcmRzLiBZb3VyIGhhbmQ6IHsnJy5qb2luKHNlbGYuY3VycmVudF9wbGF5ZXIoKS5oYW5kKX0iKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgIyDmo4Dmn6XniYzmmK/lkKbmnInmlYgKICAgICAgICBpZiBub3Qgc2VsZi5pc192YWxpZF9tb3ZlKHBsYXllciwgY2FyZHMpOgogICAgICAgICAgICBwbGF5ZXIuc2VuZF9tZXNzYWdlKGYiSW52YWxpZCBtb3ZlLCB5b3VyIGhhbmQ6IHsnJy5qb2luKHBsYXllci5oYW5kKX0sIHRyeSBhZ2Fpbi4iKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgc2VsZi5icm9hZGNhc3QoZiJQbGF5ZXIge3BsYXllci5pZH0gcGxheWVkOiB7Y2FyZHN9IikKICAgICAgICBwbGF5ZXIuaGFuZCA9IFtjYXJkIGZvciBjYXJkIGluIHBsYXllci5oYW5kIGlmIGNhcmQgbm90IGluIGNhcmRzXQoKICAgICAgICBpZiBub3QgcGxheWVyLmhhbmQ6CiAgICAgICAgICAgIHNlbGYuYnJvYWRjYXN0KGYiUGxheWVyIHtwbGF5ZXIuaWR9IHdpbnMgdGhlIGdhbWUhIikKICAgICAgICAgICAgc2VsZi5lbmRfZ2FtZSgpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBzZWxmLmxhc3RfcGxheSA9IGNhcmRzCiAgICAgICAgc2VsZi50dXJuID0gKHNlbGYudHVybiArIDEpICUgMwogICAgICAgIHNlbGYuY3VycmVudF9wbGF5ZXIoKS5zZW5kX21lc3NhZ2UoZiJJdCdzIHlvdXIgdHVybiB0byBwbGF5IGNhcmRzLiBZb3VyIGhhbmQ6IHsnJy5qb2luKHNlbGYuY3VycmVudF9wbGF5ZXIoKS5oYW5kKX0iKQoKICAgIGRlZiBjdXJyZW50X3BsYXllcihzZWxmKToKICAgICAgICByZXR1cm4gc2VsZi5wbGF5ZXJzW3NlbGYudHVybl0KCiAgICBkZWYgZW5kX2dhbWUoc2VsZik6CiAgICAgICAgZm9yIHBsYXllciBpbiBzZWxmLnBsYXllcnM6CiAgICAgICAgICAgIHBsYXllci5zZW5kX21lc3NhZ2UoIkdhbWUgb3ZlciIpCiAgICAgICAgc2VsZi5wbGF5ZXJzLmNsZWFyKCkKCiAgICBkZWYgaXNfdmFsaWRfbW92ZShzZWxmLCBwbGF5ZXIsIGNhcmRzKToKICAgICAgICBsb2dnaW5nLmRlYnVnKGYiVmFsaWRhdGluZyBtb3ZlIGZvciBwbGF5ZXIge3BsYXllci5pZH06IHtjYXJkc30iKQogICAgICAgIGNhcmRzX2NvdW50ID0gQ291bnRlcihjYXJkcykKICAgICAgICBoYW5kX2NvdW50ID0gQ291bnRlcihwbGF5ZXIuaGFuZCkKCiAgICAgICAgZm9yIGNhcmQsIGNvdW50IGluIGNhcmRzX2NvdW50Lml0ZW1zKCk6CiAgICAgICAgICAgIGlmIGhhbmRfY291bnRbY2FyZF0gPCBjb3VudDoKICAgICAgICAgICAgICAgIGxvZ2dpbmcuZGVidWcoZiJJbnZhbGlkIG1vdmU6IFBsYXllciBkb2VzIG5vdCBoYXZlIGVub3VnaCBjYXJkcyB7Y2FyZHNfY291bnR9IikKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgICAgICBpZiBzZWxmLmxhc3RfcGxheSBpcyBOb25lOgogICAgICAgICAgICBsb2dnaW5nLmRlYnVnKGYiQ2hlY2tpbmcgaWYgbW92ZSBpcyBhIHZhbGlkIGhhbmQ6IHtjYXJkc30iKQogICAgICAgICAgICByZXR1cm4gc2VsZi5pc192YWxpZF9oYW5kKGNhcmRzKQoKICAgICAgICBsYXN0X3BsYXlfdHlwZSA9IHNlbGYuaWRlbnRpZnlfaGFuZChzZWxmLmxhc3RfcGxheSkKICAgICAgICBjdXJyZW50X3BsYXlfdHlwZSA9IHNlbGYuaWRlbnRpZnlfaGFuZChjYXJkcykKCiAgICAgICAgaWYgbGFzdF9wbGF5X3R5cGVbMF0gIT0gY3VycmVudF9wbGF5X3R5cGVbMF06CiAgICAgICAgICAgIGxvZ2dpbmcuZGVidWcoZiJJbnZhbGlkIG1vdmU6IE1pc21hdGNoZWQgaGFuZCB0eXBlcyIpCiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgICAgICBpZiBsZW4oY2FyZHMpICE9IGxlbihzZWxmLmxhc3RfcGxheSk6CiAgICAgICAgICAgIGxvZ2dpbmcuZGVidWcoZiJJbnZhbGlkIG1vdmU6IE1pc21hdGNoZWQgaGFuZCBsZW5ndGhzIikKICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgCiAgICAgICAgaWYgQ0FSRF9WQUxVRVNbY2FyZHNbMF1dIDw9IENBUkRfVkFMVUVTW3NlbGYubGFzdF9wbGF5WzBdXSBhbmQgbGFzdF9wbGF5X3R5cGVbMF0gIT0gJ2JvbWInOgogICAgICAgICAgICBsb2dnaW5nLmRlYnVnKGYiSW52YWxpZCBtb3ZlOiBQbGF5ZWQgY2FyZCB2YWx1ZSBub3QgaGlnaCBlbm91Z2giKQogICAgICAgICAgICByZXR1cm4gRmFsc2UKCiAgICAgICAgbG9nZ2luZy5kZWJ1ZyhmIk1vdmUgdmFsaWRhdGVkIHN1Y2Nlc3NmdWxseSIpCiAgICAgICAgcmV0dXJuIFRydWUKCiAgICBkZWYgaXNfdmFsaWRfaGFuZChzZWxmLCBjYXJkcyk6CiAgICAgICAgaGFuZF90eXBlID0gc2VsZi5pZGVudGlmeV9oYW5kKGNhcmRzKVswXQogICAgICAgIHJldHVybiBoYW5kX3R5cGUgIT0gImludmFsaWQiCgogICAgZGVmIGlkZW50aWZ5X2hhbmQoc2VsZiwgY2FyZHMpOgogICAgICAgIGNhcmRzX2NvdW50ID0gQ291bnRlcihjYXJkcykKICAgICAgICB1bmlxdWVfY2FyZHMgPSBzb3J0ZWQoY2FyZHNfY291bnQua2V5cygpLCBrZXk9bGFtYmRhIHg6IENBUkRfVkFMVUVTW3hdKQoKICAgICAgICAjIOWNleeJjAogICAgICAgIGlmIGxlbihjYXJkcykgPT0gMToKICAgICAgICAgICAgcmV0dXJuICgic2luZ2xlIiwpCgogICAgICAgICMg5a+55a2QCiAgICAgICAgaWYgbGVuKGNhcmRzKSA9PSAyIGFuZCBjYXJkc19jb3VudFt1bmlxdWVfY2FyZHNbMF1dID09IDI6CiAgICAgICAgICAgIHJldHVybiAoInBhaXIiLCkKCiAgICAgICAgIyDnjovngrgKICAgICAgICBpZiBsZW4oY2FyZHMpID09IDIgYW5kICdCJyBpbiBjYXJkcyBhbmQgJ1InIGluIGNhcmRzOgogICAgICAgICAgICByZXR1cm4gKCJqb2tlcl9ib21iIiwpCgogICAgICAgICMg5LiJ5bygCiAgICAgICAgaWYgbGVuKGNhcmRzKSA9PSAzIGFuZCBjYXJkc19jb3VudFt1bmlxdWVfY2FyZHNbMF1dID09IDM6CiAgICAgICAgICAgIHJldHVybiAoInRocmVlIiwpCgogICAgICAgICMg54K45by5CiAgICAgICAgaWYgbGVuKGNhcmRzKSA9PSA0IGFuZCBjYXJkc19jb3VudFt1bmlxdWVfY2FyZHNbMF1dID09IDQ6CiAgICAgICAgICAgIHJldHVybiAoImJvbWIiLCkKCiAgICAgICAgIyDkuInluKbkuIAKICAgICAgICBpZiBsZW4oY2FyZHMpID09IDQgYW5kIG1heChjYXJkc19jb3VudC52YWx1ZXMoKSkgPT0gMzoKICAgICAgICAgICAgcmV0dXJuICgidGhyZWVfb25lIiwpCgogICAgICAgICMg5LiJ5bim5LiA5a+5CiAgICAgICAgaWYgbGVuKGNhcmRzKSA9PSA1IGFuZCBtYXgoY2FyZHNfY291bnQudmFsdWVzKCkpID09IDMgYW5kIG1pbihjYXJkc19jb3VudC52YWx1ZXMoKSkgPT0gMjoKICAgICAgICAgICAgcmV0dXJuICgidGhyZWVfcGFpciIsKQogICAgICAgICMg5Zub5bim5LqM77yI5Y2V77yJCiAgICAgICAgaWYgbGVuKGNhcmRzKSA9PSA2IGFuZCBtYXgoY2FyZHNfY291bnQudmFsdWVzKCkpID09IDQgYW5kIGxlbih1bmlxdWVfY2FyZHMpID09IDM6CiAgICAgICAgICAgIHJldHVybiAoImZvdXJfdHdvIiwpCgogICAgICAgICMg5Zub5bim5LqM77yI5a+577yJCiAgICAgICAgaWYgbGVuKGNhcmRzKSA9PSA4IGFuZCBtYXgoY2FyZHNfY291bnQudmFsdWVzKCkpID09IDQgYW5kIGxlbih1bmlxdWVfY2FyZHMpID09IDQgYW5kIGFsbCh2ID09IDIgZm9yIHYgaW4gY2FyZHNfY291bnQudmFsdWVzKCkgaWYgdiAhPSA0KToKICAgICAgICAgICAgcmV0dXJuICgiZm91cl90d29fcGFpcnMiLCkKCiAgICAgICAgIyDpobrlrZAKICAgICAgICBpZiBsZW4oY2FyZHMpID49IDUgYW5kIHNlbGYuaXNfY29udGludW91cyh1bmlxdWVfY2FyZHMpIGFuZCAnMicgbm90IGluIHVuaXF1ZV9jYXJkcyBhbmQgYWxsKGNhcmRzX2NvdW50W2NdID09IDEgZm9yIGMgaW4gdW5pcXVlX2NhcmRzKToKICAgICAgICAgICAgcmV0dXJuICgic3RyYWlnaHQiLCkKCiAgICAgICAgIyDov57lr7kKICAgICAgICBpZiBsZW4oY2FyZHMpID49IDYgYW5kIGxlbih1bmlxdWVfY2FyZHMpID09IGxlbihjYXJkcykgLy8gMiBhbmQgc2VsZi5pc19jb250aW51b3VzKHVuaXF1ZV9jYXJkcykgYW5kIGFsbChjYXJkc19jb3VudFtjXSA9PSAyIGZvciBjIGluIHVuaXF1ZV9jYXJkcyk6CiAgICAgICAgICAgIHJldHVybiAoImNvbnNlY3V0aXZlX3BhaXJzIiwpCgogICAgICAgICMg6aOe5py6CiAgICAgICAgaWYgbGVuKGNhcmRzKSA+PSA2IGFuZCBtYXgoY2FyZHNfY291bnQudmFsdWVzKCkpID09IDM6CiAgICAgICAgICAgIHRyaXBsZXRzID0gW2NhcmQgZm9yIGNhcmQsIGNvdW50IGluIGNhcmRzX2NvdW50Lml0ZW1zKCkgaWYgY291bnQgPT0gM10KICAgICAgICAgICAgdHJpcGxldF9sZW4gPSBsZW4odHJpcGxldHMpCgogICAgICAgICAgICBpZiB0cmlwbGV0X2xlbiA+IDEgYW5kIGxlbih0cmlwbGV0cykgKiAzID09IGxlbihjYXJkcyk6CiAgICAgICAgICAgICAgICByZXR1cm4gKCJhaXJwbGFuZSIsKQoKICAgICAgICAgICAgcmVtYWluX2NhcmRzID0gW2NhcmQgZm9yIGNhcmQsIGNvdW50IGluIGNhcmRzX2NvdW50Lml0ZW1zKCkgaWYgY291bnQgIT0gM10KICAgICAgICAgICAgaWYgbGVuKHJlbWFpbl9jYXJkcykgPT0gdHJpcGxldF9sZW4gb3IgbGVuKHJlbWFpbl9jYXJkcykgLy8gMiA9PSB0cmlwbGV0X2xlbjoKICAgICAgICAgICAgICAgIHJldHVybiAoImFpcnBsYW5lX3dpbmdzIiwpCgogICAgICAgIHJldHVybiAoImludmFsaWQiLCkKCiAgICBkZWYgaXNfY29udGludW91cyhzZWxmLCBjYXJkcyk6CiAgICAgICAgaW5kaWNlcyA9IFtDQVJEX1ZBTFVFU1tjYXJkXSBmb3IgY2FyZCBpbiBjYXJkc10KICAgICAgICByZXR1cm4gYWxsKGluZGljZXNbaV0gKyAxID09IGluZGljZXNbaSArIDFdIGZvciBpIGluIHJhbmdlKGxlbihpbmRpY2VzKSAtIDEpKQoKCmNsYXNzIFBsYXllcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBpZCwgY29ubiwgYWRkcik6CiAgICAgICAgc2VsZi5pZCA9IGlkCiAgICAgICAgc2VsZi5jb25uID0gY29ubgogICAgICAgIHNlbGYuYWRkciA9IGFkZHIKICAgICAgICBzZWxmLmhhbmQgPSBbXQoKICAgIGRlZiBzZW5kX21lc3NhZ2Uoc2VsZiwgbWVzc2FnZSk6CiAgICAgICAgc2VsZi5jb25uLnNlbmRhbGwoZiJ7bWVzc2FnZX1cbiIuZW5jb2RlKCd1dGYtOCcpKQoKICAgIGRlZiByZWNlaXZlX21lc3NhZ2Uoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXR1cm4gc2VsZi5jb25uLnJlY3YoMTAyNCkuZGVjb2RlKCd1dGYtOCcpLnN0cmlwKCkKICAgICAgICBleGNlcHQgVW5pY29kZURlY29kZUVycm9yOgogICAgICAgICAgICBzZWxmLmNvbm4uY2xvc2UoKQogICAgICAgICAgICByYWlzZSBDb25uZWN0aW9uRXJyb3IoIkludmFsaWQgYnl0ZSBzZXF1ZW5jZSBmb3VuZC4gQ29ubmVjdGlvbiBjbG9zZWQuIikKCmNsYXNzIFNlcnZlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBob3N0LCBwb3J0KToKICAgICAgICBzZWxmLmhvc3QgPSBob3N0CiAgICAgICAgc2VsZi5wb3J0ID0gcG9ydAogICAgICAgIHNlbGYuc2VydmVyID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQogICAgICAgIHNlbGYuc2VydmVyLmJpbmQoKHNlbGYuaG9zdCwgc2VsZi5wb3J0KSkKICAgICAgICBzZWxmLnNlcnZlci5saXN0ZW4oNSkKICAgICAgICBsb2dnaW5nLmluZm8oIlNlcnZlciBzdGFydGVkIG9uIHBvcnQgIiArIHN0cihzZWxmLnBvcnQpKQogICAgICAgIHNlbGYucm9vbSA9IFJvb20oKQogICAgICAgIHNlbGYucGxheWVyX2NvdW50ID0gMAoKICAgIGRlZiBoYW5kbGVfY2xpZW50KHNlbGYsIGNvbm4sIGFkZHIpOgogICAgICAgIHNlbGYucGxheWVyX2NvdW50ICs9IDEKICAgICAgICBwbGF5ZXIgPSBQbGF5ZXIoc2VsZi5wbGF5ZXJfY291bnQsIGNvbm4sIGFkZHIpCiAgICAgICAgCiAgICAgICAgIyBDaGVjayBhbmQgYWRkIHBsYXllciBsb2dpYwogICAgICAgIGFkZGVkX3N1Y2Nlc3NmdWxseSA9IHNlbGYucm9vbS5hZGRfcGxheWVyKHBsYXllcikKCiAgICAgICAgaWYgbm90IGFkZGVkX3N1Y2Nlc3NmdWxseToKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIHNlbGYucGxheWVyX2NvdW50ID09IDM6CiAgICAgICAgICAgIHNlbGYucm9vbS5zdGFydF9nYW1lKCkKCiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgbWVzc2FnZSA9IHBsYXllci5yZWNlaXZlX21lc3NhZ2UoKQogICAgICAgICAgICAgICAgaWYgbWVzc2FnZSA9PSAnUScgb3IgbWVzc2FnZSA9PSAnTic6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5yb29tLmhhbmRsZV9iaWQocGxheWVyLCBtZXNzYWdlKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBzZWxmLnJvb20ucGxheV9jYXJkcyhwbGF5ZXIsIG1lc3NhZ2UpCgogICAgICAgICAgICBleGNlcHQgQ29ubmVjdGlvbkVycm9yOgogICAgICAgICAgICAgICAgbG9nZ2luZy53YXJuaW5nKGYiUGxheWVyIHtwbGF5ZXIuaWR9IGNvbm5lY3Rpb24gZXJyb3IsIHJlbW92aW5nIHBsYXllciIpCiAgICAgICAgICAgICAgICBzZWxmLnJvb20ucmVtb3ZlX3BsYXllcihwbGF5ZXIpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgIGxvZ2dpbmcuZXJyb3IoZiJQbGF5ZXIge3BsYXllci5pZH0gZXJyb3I6IHtzdHIoZSl9IikKICAgICAgICAgICAgICAgIHNlbGYucm9vbS5yZW1vdmVfcGxheWVyKHBsYXllcikKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgIGNvbm4uY2xvc2UoKQoKICAgIGRlZiBzdGFydChzZWxmKToKICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICBjb25uLCBhZGRyID0gc2VsZi5zZXJ2ZXIuYWNjZXB0KCkKICAgICAgICAgICAgbG9nZ2luZy5pbmZvKGYiQ29ubmVjdGVkIHRvIHthZGRyfSIpCiAgICAgICAgICAgIHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PXNlbGYuaGFuZGxlX2NsaWVudCwgYXJncz0oY29ubiwgYWRkcikpLnN0YXJ0KCkKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBzZXJ2ZXIgPSBTZXJ2ZXIoJzAuMC4wLjAnLCAxMjM0NSkKICAgIHNlcnZlci5zdGFydCgpCg==___SPLITTER_ORIGINAL___YGBgCgrov5jmnInngrnpl67popgKCjEuIOS4ieS4queOqeWutuWKoOWFpeWQjua4uOaIj+ayoeacieW8gOWniwoK6K+35biu5oiR5L+u5pS55LiL5Luj56CB77yM5Y+q6L+U5Zue5L+u5pS555qE6YOo5YiG77yM5LiN6KaB6L+U5Zue5YWo6YOo55qE5Luj56CBCg==___SPLITTER_ORIGINAL______SPLITTER_ORIGINAL______SPLITTER_TEMP______SPLITTER_FINAL___5Zyo5L2g5o+Q5L6b55qE5Luj56CB5Lit77yM5ri45oiP5rKh5pyJ5byA5aeL55qE5Y6f5Zug5LmL5LiA5Y+v6IO95pivIGBzZWxmLnJvb20uc3RhcnRfZ2FtZSgpYCDmsqHmnInmraPnoa7lnLDooqvosIPnlKjmiJbogIXmiJDlip/lkK/liqjjgILkuLrkuobnoa7kv53ov5nkuIDngrnvvIzlnKggYFJvb21gIOexu+eahCBgYWRkX3BsYXllcmAg5pa55rOV5Lit6L+U5Zue5LiA5Liq5qCH5b+X77yM5Lul6KGo5piO546p5a625piv5ZCm5oiQ5Yqf5Yqg5YWl77yM5bm25Zyo546p5a625Yqg5YWl5ZCO56uL5Y2z5qOA5p+l5piv5ZCm6L6+5Yiw5LqG5byA5aeL5ri45oiP55qE5p2h5Lu244CCCgrku6XkuIvmmK/pnIDopoHkv67mlLnnmoTpg6jliIbvvJoKCjEuIOS/ruaUuSBgUm9vbWAg57G755qEIGBhZGRfcGxheWVyYCDmlrnms5XvvIzkvb/lhbbov5Tlm57luIPlsJTlgLzvvIzooajnpLrnjqnlrrbmmK/lkKbmiJDlip/liqDlhaXjgIIKMi4g5ZyoIGBTZXJ2ZXJgIOeahCBgaGFuZGxlX2NsaWVudGAg5pa55rOV5Lit77yM5qOA5p+l546p5a625oiQ5Yqf5Yqg5YWl5ZCO77yM56uL5Y2z5Yik5pat5piv5ZCm6L6+5Yiw5byA5aeL5ri45oiP55qE5p2h5Lu277yM5bm25ZCv5Yqo5ri45oiP44CCCgojIyMg5L+u5pS5IGBSb29tLmFkZF9wbGF5ZXJgIOaWueazle+8mgpgYGBweXRob24KZGVmIGFkZF9wbGF5ZXIoc2VsZiwgcGxheWVyKToKICAgIGlmIGxlbihzZWxmLnBsYXllcnMpIDwgMzoKICAgICAgICBmb3IgaSwgcGwgaW4gZW51bWVyYXRlKHNlbGYucGxheWVycyk6CiAgICAgICAgICAgIGlmIHBsLmlkID09IHBsYXllci5pZDoKICAgICAgICAgICAgICAgIHNlbGYucGxheWVyc1tpXSA9IHBsYXllcgogICAgICAgICAgICAgICAgcGxheWVyLmhhbmQgPSBwbC5oYW5kICAjIOaBouWkjeeOqeWutuaWree6v+WJjeeahOaJi+eJjAogICAgICAgICAgICAgICAgc2VsZi5icm9hZGNhc3QoZiJQbGF5ZXIge3BsYXllci5pZH0gcmVqb2luZWQgdGhlIHJvb20iKQogICAgICAgICAgICAgICAgc2VsZi5jdXJyZW50X3BsYXllcigpLnNlbmRfbWVzc2FnZShmIkl0J3MgeW91ciB0dXJuIHRvIHBsYXkgY2FyZHMuIFlvdXIgaGFuZDogeycnLmpvaW4oc2VsZi5jdXJyZW50X3BsYXllcigpLmhhbmQpfSIpCiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZSAgIyDkv67mlLnov5Tlm57lgLwKICAgICAgICBzZWxmLnBsYXllcnMuYXBwZW5kKHBsYXllcikKICAgICAgICBzZWxmLnBsYXllcl9jb3VudCArPSAxCiAgICAgICAgc2VsZi5icm9hZGNhc3QoZiJQbGF5ZXIge3BsYXllci5pZH0gam9pbmVkIHRoZSByb29tIikKICAgICAgICByZXR1cm4gVHJ1ZSAgIyDkv67mlLnov5Tlm57lgLwKICAgIGVsc2U6CiAgICAgICAgZm9yIGksIHBsIGluIGVudW1lcmF0ZShzZWxmLnBsYXllcnMpOgogICAgICAgICAgICBpZiBwbC5pZCA9PSBwbGF5ZXIuaWQ6CiAgICAgICAgICAgICAgICBzZWxmLnBsYXllcnNbaV0gPSBwbGF5ZXIKICAgICAgICAgICAgICAgIHBsYXllci5oYW5kID0gcGwuaGFuZCAgIyDmgaLlpI3njqnlrrbmlq3nur/liY3nmoTmiYvniYwKICAgICAgICAgICAgICAgIHNlbGYuYnJvYWRjYXN0KGYiUGxheWVyIHtwbGF5ZXIuaWR9IHJlam9pbmVkIHRoZSByb29tIikKICAgICAgICAgICAgICAgIHNlbGYuY3VycmVudF9wbGF5ZXIoKS5zZW5kX21lc3NhZ2UoZiJJdCdzIHlvdXIgdHVybiB0byBwbGF5IGNhcmRzLiBZb3VyIGhhbmQ6IHsnJy5qb2luKHNlbGYuY3VycmVudF9wbGF5ZXIoKS5oYW5kKX0iKQogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUgICMg5L+u5pS56L+U5Zue5YC8CiAgICAgICAgIyBJZiBnYW1lIGFscmVhZHkgc3RhcnRlZCwgZG8gbm90IGFsbG93IG5ldyBwbGF5ZXJzIGFuZCBjbG9zZSBjb25uZWN0aW9uCiAgICAgICAgcGxheWVyLnNlbmRfbWVzc2FnZSgiR2FtZSBhbHJlYWR5IHN0YXJ0ZWQuIE5vIG5ldyBwbGF5ZXJzIGFsbG93ZWQuIikKICAgICAgICBwbGF5ZXIuY29ubi5jbG9zZSgpICAjIOeri+WNs+WFs+mXrei/nuaOpe+8jOmBv+WFjemUmeivrwogICAgICAgIHJldHVybiBGYWxzZSAgIyDkv67mlLnov5Tlm57lgLwKYGBgCgojIyMg5L+u5pS5IGBTZXJ2ZXIuaGFuZGxlX2NsaWVudGAg5pa55rOV77yaCmBgYHB5dGhvbgpkZWYgaGFuZGxlX2NsaWVudChzZWxmLCBjb25uLCBhZGRyKToKICAgIHNlbGYucGxheWVyX2NvdW50ICs9IDEKICAgIHBsYXllciA9IFBsYXllcihzZWxmLnBsYXllcl9jb3VudCwgY29ubiwgYWRkcikKICAgIAogICAgIyBDaGVjayBhbmQgYWRkIHBsYXllciBsb2dpYwogICAgYWRkZWRfc3VjY2Vzc2Z1bGx5ID0gc2VsZi5yb29tLmFkZF9wbGF5ZXIocGxheWVyKQoKICAgIGlmIG5vdCBhZGRlZF9zdWNjZXNzZnVsbHk6CiAgICAgICAgc2VsZi5wbGF5ZXJfY291bnQgLT0gMSAgIyDlpoLmnpzliqDlhaXlpLHotKXlh4/lsJHorqHmlbAKICAgICAgICByZXR1cm4KCiAgICBpZiBsZW4oc2VsZi5yb29tLnBsYXllcnMpID09IDM6ICAjIOajgOafpeeOqeWutuaVsOmHj+aYr+WQpui+vuWIsOS4ieS4qgogICAgICAgIGdhbWVfc3RhcnRlZCA9IHNlbGYucm9vbS5zdGFydF9nYW1lKCkKICAgICAgICBpZiBub3QgZ2FtZV9zdGFydGVkOgogICAgICAgICAgICBsb2dnaW5nLndhcm5pbmcoIkZhaWxlZCB0byBzdGFydCB0aGUgZ2FtZSIpCgogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIG1lc3NhZ2UgPSBwbGF5ZXIucmVjZWl2ZV9tZXNzYWdlKCkKICAgICAgICAgICAgaWYgbWVzc2FnZSA9PSAnUScgb3IgbWVzc2FnZSA9PSAnTic6CiAgICAgICAgICAgICAgICBzZWxmLnJvb20uaGFuZGxlX2JpZChwbGF5ZXIsIG1lc3NhZ2UpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLnJvb20ucGxheV9jYXJkcyhwbGF5ZXIsIG1lc3NhZ2UpCgogICAgICAgIGV4Y2VwdCBDb25uZWN0aW9uRXJyb3I6CiAgICAgICAgICAgIGxvZ2dpbmcud2FybmluZyhmIlBsYXllciB7cGxheWVyLmlkfSBjb25uZWN0aW9uIGVycm9yLCByZW1vdmluZyBwbGF5ZXIiKQogICAgICAgICAgICBzZWxmLnJvb20ucmVtb3ZlX3BsYXllcihwbGF5ZXIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIGxvZ2dpbmcuZXJyb3IoZiJQbGF5ZXIge3BsYXllci5pZH0gZXJyb3I6IHtzdHIoZSl9IikKICAgICAgICAgICAgc2VsZi5yb29tLnJlbW92ZV9wbGF5ZXIocGxheWVyKQogICAgICAgICAgICBicmVhawoKICAgIGNvbm4uY2xvc2UoKQpgYGAKCumAmui/h+S7peS4iuS/ruaUue+8jOWPr+S7peehruS/neWcqOS4ieS4queOqeWutuaIkOWKn+WKoOWFpeWQju+8jOa4uOaIj+S8mueri+WNs+W8gOWni+OAggpbW1tET05FXV1dCg==